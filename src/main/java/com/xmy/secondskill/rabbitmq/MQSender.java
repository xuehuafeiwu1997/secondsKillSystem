package com.xmy.secondskill.rabbitmq;import com.xmy.secondskill.redis.RedisService;import org.apache.logging.log4j.message.ObjectMessage;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.amqp.core.AmqpTemplate;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;/** * @author xmy * @date 2021/3/29 11:38 下午 */@Servicepublic class MQSender {    private static Logger log = LoggerFactory.getLogger(MQSender.class);    @Autowired    AmqpTemplate amqpTemplate;    public void send(Object message) {        String msg =  RedisService.beanToString(message);        log.info("send message:" + msg);        amqpTemplate.convertAndSend(MQConfig.QUEUE,msg);    }    public void sendTopic(Object message) {        String msg = RedisService.beanToString(message);        log.info("send topic message:" + msg);        amqpTemplate.convertAndSend(MQConfig.TOPIC_EXCHANGE,"topic.key1",msg+"1");        amqpTemplate.convertAndSend(MQConfig.TOPIC_EXCHANGE,"topic.key2",msg+"2");    }}